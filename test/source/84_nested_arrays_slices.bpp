// Covers: nested arrays/slices, multi-dimensional indexing, sizeof on nested types
// Expect exit code: 0

func main(argc: i64, argv: *u64) -> i64 {
    var mat: [2][3]i64;
    var next: i64 = 1;
    for (var i: i64 = 0; i < 2; i = i + 1) {
        for (var j: i64 = 0; j < 3; j = j + 1) {
            mat[i][j] = next;
            next = next + 1;
        }
    }

    if (mat[0][0] != 1) { return 1; }
    if (mat[0][2] != 3) { return 2; }
    if (mat[1][0] != 4) { return 3; }
    if (mat[1][2] != 6) { return 4; }
    if (sizeof(mat) != 48) { return 5; }
    if (sizeof([2][3]i64) != 48) { return 6; }

    var cube: [2][3][4]u8;
    cube[1][2][3] = 99;
    if (cube[1][2][3] != 99) { return 7; }
    if (sizeof(cube) != 24) { return 8; }
    if (sizeof([2][3][4]u8) != 24) { return 9; }

    var rows: [2][3]u8;
    rows[1][2] = 7;
    var row_slice: [][3]u8 = slice(&rows[0], 2);
    if (row_slice[1][2] != 7) { return 10; }

    row_slice[0][1] = 11;
    if (rows[0][1] != 11) { return 11; }

    if (sizeof(row_slice[0]) != 3) { return 12; }

    return 0;
}
