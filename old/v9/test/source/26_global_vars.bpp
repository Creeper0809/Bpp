// Covers: global variables across integer, pointer, array, slice, struct types
// Mode: ssa|nossa
// Opt: O0|O1
// Expect exit code: 0

struct Pair {
    public a: u32;
    public b: u64;
}

var g_u8: u8 = 1;
var g_u16: u16 = 2;
var g_u32: u32 = 3;
var g_u64: u64 = 4;
var g_i64: i64 = 5;
var g_ptr: *u8;
var g_arr: [4]u16;
var g_slice: []u8;
var g_pair: Pair = Pair { 7, 1000 };

func main() -> u64 {
    // Import

    // Setup
    var buf: [8]u8;
    for (var i: u64 = 0; i < 8; i++) {
        buf[i] = (u8)(10 + i);
    }

    g_arr[0] = 10;
    g_arr[1] = 20;
    g_arr[2] = 30;
    g_arr[3] = 40;

    g_ptr = &buf[3];
    *g_ptr = 42;

    var local_slice: []u8 = slice(&buf[2], 4);
    g_slice = local_slice;

    // Execution
    var total: u64 = 0;
    total = total + (u64)g_u8;
    total = total + (u64)g_u16;
    total = total + (u64)g_u32;
    total = total + g_u64;
    total = total + (u64)g_i64;
    total = total + (u64)g_arr[0];
    total = total + (u64)g_arr[1];
    total = total + (u64)g_pair.a;
    total = total + g_pair.b;
    total = total + (u64)g_slice[0];
    total = total + (u64)g_slice[1];
    total = total + (u64)g_slice[3];
    // Assertion
    if (total != 1121) { return 1; }
    return 0;
}
