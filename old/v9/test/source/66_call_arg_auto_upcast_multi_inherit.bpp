// Covers: automatic argument-time upcast (*Child -> *Parent) in function calls
// Expect exit code: 0

struct Left {
    public l: u64;
}

struct Right {
    public r: u64;
}

struct Child : Left, Right {
    public c: u64;
}

func read_left(p: *Left) -> u64 {
    return p.l;
}

func read_right(p: *Right) -> u64 {
    return p.r;
}

func main() -> u64 {
    var x: Child;
    x.l = 10;
    x.r = 20;
    x.c = 30;

    var cp: *Child = &x;

    // First parent (offset 0)
    if (read_left(cp) != 10) { return 1; }

    // Non-first parent requires pointer adjustment by parent layout offset
    if (read_right(cp) != 20) { return 2; }

    return 0;
}
