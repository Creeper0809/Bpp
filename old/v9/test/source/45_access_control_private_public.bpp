// Covers: private/public field+method access semantics and default-private impl method behavior
// Expect exit code: 0

struct Vault {
    private secret: i64;
    public opened: i64;
}

impl Vault {
    public func touch_private(self: *Vault) -> i64 {
        return self.secret + 1;
    }

    private func read_secret(self: *Vault) -> i64 {
        return self.secret;
    }

    public func set_secret(self: *Vault, v: i64) {
        self.secret = v;
    }

    public func open(self: *Vault) -> i64 {
        self.opened = self.read_secret();
        return self.touch_private() - 1;
    }
}

func main() -> i64 {
    var v: Vault;
    v.opened = 0;
    v.set_secret(123);

    var r: i64 = v.open();
    if (r != 123) { return 1; }
    if (v.opened != 123) { return 2; }

    v.opened = v.opened + 10;
    if (v.opened != 133) { return 3; }

    return 0;
}
