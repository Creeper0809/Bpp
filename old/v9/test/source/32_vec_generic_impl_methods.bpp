// Covers: generic impl method instantiation for Vec<T>
// Expect exit code: 0

import std.vec;

struct Foo {
    public v: u64;
}

func make_foo(val: u64) -> *Foo {
    return new Foo{val};
}

func main() -> u64 {
    // Import

    // Setup
    var vec: *Vec<*Foo> = new Vec<*Foo>(4);
    var f0: *Foo = make_foo(10);
    var f1: *Foo = make_foo(20);

    // Execution
    vec.push(f0);
    vec.push(f1);
    if (vec.len() != 2) { return 1; }
    var g0: *Foo = vec.get(0);
    var g1: *Foo = vec.get(1);

    // Assertion
    if (g0.v != 10) { return 2; }
    if (g1.v != 20) { return 3; }
    return 0;
}
