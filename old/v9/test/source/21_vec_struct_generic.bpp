// Covers: Vec<T> storing struct values (sizeof(T) stride)
// Mode: ssa|nossa
// Opt: O0|O1
// Expect exit code: 0

import std.vec;

struct Point {
    public x: u64;
    public y: u64;
}

func main() -> u64 {
    // Setup
    if (sizeof(Point) != 16) { return 10; }
    var v: *Vec<Point> = (*Vec<Point>)new Vec<Point>(4);

    var p0: Point;
    p0.x = 11;
    p0.y = 22;

    var p1: Point;
    p1.x = 33;
    p1.y = 44;

    // Execution
    v.push(p0);
    v.push(p1);

    // Assertion
    if (v.len() != 2) { return 1; }

    var g0: Point = v.get(0);
    var g1: Point = v.get(1);

    if (g0.x != 11) { return 2; }
    if (g0.y != 22) { return 3; }
    if (g1.x != 33) { return 4; }
    if (g1.y != 44) { return 5; }

    return 0;
}
