// Covers: Option<T> and Result<T,E> basic construction and methods
// Mode: ssa|nossa
// Opt: O0|O1
// Expect exit code: 0

import std.option;
import std.result;

struct Pair {
    public a: u64;
    public b: u64;
}

func main() -> u64 {
    // Import

    // Setup
    var p: Pair;
    p.a = 1;
    p.b = 2;

    // Execution
    var opt1: Option<u64> = Option_some<u64>(10);
    if (opt1.is_some() == 0) { return 1; }
    if (opt1.unwrap() != 10) { return 2; }

    var opt2: Option<u64> = Option_none<u64>();
    if (opt2.is_none() == 0) { return 3; }
    if (opt2.unwrap_or(7) != 7) { return 4; }

    var opt3: Option<Pair> = Option_some<Pair>(p);
    var p2: Pair = opt3.unwrap();
    if (p2.a != 1) { return 5; }
    if (p2.b != 2) { return 6; }

    var ok: Result<u64, u64> = Result_ok<u64, u64>(42);
    if (ok.is_ok() == 0) { return 7; }
    if (ok.unwrap() != 42) { return 8; }

    var err: Result<u64, u64> = Result_err<u64, u64>(9);
    if (err.is_err() == 0) { return 9; }
    if (err.unwrap_or(5) != 5) { return 10; }
    if (err.unwrap_err() != 9) { return 11; }

    // Assertion
    return 0;
}
