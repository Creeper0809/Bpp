// Covers: debug keywords + __LINE__ macro behaviors (old 14, 43)
// Expect exit code: 0

func line_value() -> i64 {
    return __LINE__;
}

func line_delta() -> i64 {
    var a: i64 = __LINE__;
    var b: i64 = __LINE__;
    return b - a;
}

func main(argc, argv) -> i64 {
    // old 43 path
    var x: i64 = 3;
    assert(x == 3);
    if (0) {
        todo;
    }
    if (0) {
        unreachable;
    }

    // old 14 path
    var l0: i64 = __LINE__;
    var l1: i64 = __LINE__;
    var l2: i64 = __LINE__;
    var sum: i64 = 0;

    if (l1 != l0 + 1) { return 1; }
    if (l2 != l1 + 1) { return 2; }

    for (var i: i64 = 0; i < 1000; i = i + 1) {
        sum = sum + line_value();
    }
    if (sum != line_value() * 1000) { return 3; }

    var delta_sum: i64 = 0;
    for (var k: i64 = 0; k < 5; k = k + 1) {
        var d: i64 = line_delta();
        if (d == 1) {
            delta_sum = delta_sum + k;
        } else {
            delta_sum = delta_sum - 100;
        }
    }
    if (delta_sum != 10) { return 4; }

    var base: i64 = line_value();
    var guard: i64 = 0;
    var check: i64 = 0;
    while (guard < 4) {
        if (line_value() != base) { return 5; }
        check = check + (base & 3);
        guard = guard + 1;
    }
    if (check != (base & 3) * 4) { return 6; }

    return 0;
}
