// Covers: HashMap basic put/get/has/update
// Mode: ssa|nossa
// Opt: O0|O1
// Expect exit code: 0

import std.hashmap;

func main() -> u64 {
    // Import

    // Setup
    var map: *HashMap<u64, u64> = (*HashMap<u64, u64>)HashMap.new<u64, u64>(2);
    var k1: u64 = "a";
    var k2: u64 = "bb";
    var k3: u64 = "ccc";
    var k4: u64 = "dddd";
    var k_missing: u64 = "zz";

    // Execution
    map->put(k1, 1, 10);
    map->put(k2, 2, 20);
    map->put(k3, 3, 30);
    map->put(k4, 4, 40);

    if (map->has(k1, 1) == 0) { return 1; }
    if (map->has(k2, 2) == 0) { return 2; }
    if (map->has(k3, 3) == 0) { return 3; }
    if (map->has(k4, 4) == 0) { return 4; }

    if (map->get(k1, 1) != 10) { return 5; }
    if (map->get(k2, 2) != 20) { return 6; }
    if (map->get(k3, 3) != 30) { return 7; }
    if (map->get(k4, 4) != 40) { return 8; }

    map->put(k2, 2, 222);
    if (map->get(k2, 2) != 222) { return 9; }

    if (map->has(k_missing, 2) != 0) { return 10; }
    if (map->get(k_missing, 2) != 0) { return 11; }

    // Assertion
    return 0;
}
