// Covers: struct return, nested return, conditional return (stress)
// Expect exit code: 0

struct Pair {
    first: i64;
    second: i64;
}

func make_pair(a: i64, b: i64) -> Pair {
    var p: Pair;
    p.first = a;
    p.second = b;
    return p;
}

func choose_pair(flag: i64) -> Pair {
    if (flag != 0) { return make_pair(10, 32); }
    return make_pair(20, 22);
}

func main(argc, argv) -> i64 {
    // Import

    // Setup
    var p0: Pair = make_pair(40, 2);
    var p1: Pair = choose_pair(1);
    var sum: i64 = 0;

    // Execution
    if (p0.first + p0.second != 42) { return 1; }
    if (p1.first + p1.second != 42) { return 2; }

    // Stress: 반복 선택 반환 누적
    for (var i: i64 = 0; i < 100; i = i + 1) {
        var pick: Pair = choose_pair(i & 1);
        sum = sum + pick.first + pick.second;
    }
    if (sum != 4200) { return 3; }

    // Assertion
    return 0;
}
