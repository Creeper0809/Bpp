// Covers: SSA generic pointer arithmetic scaling
// Mode: ssa
// Opt: O0
// Expect exit code: 0

// Import

func ptr_add<T>(p: *T, idx: u64) -> *T {
    return p + idx;
}

func main() -> u64 {
    // Setup
    var arr64: [4]u64;
    arr64[0] = 10;
    arr64[1] = 20;
    arr64[2] = 30;
    arr64[3] = 40;

    var arr8: [4]u8;
    arr8[0] = 1;
    arr8[1] = 2;
    arr8[2] = 3;
    arr8[3] = 4;

    // Execution
    var p64: *u64 = ptr_add<u64>(&arr64[0], 2);
    var p8: *u8 = ptr_add<u8>(&arr8[0], 3);

    // Assertion
    if (*p64 != 30) { return 14; }
    if (*p8 != 4) { return 15; }
    return 0;
}
