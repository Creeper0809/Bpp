// Covers: impl methods, self calls, method chaining (stress)
// Expect exit code: 0

struct Counter {
    value: i64;
}

impl Counter {
    func init(self: *Counter, v: i64) {
        self->value = v;
    }

    func add(self: *Counter, n: i64) {
        self->value = self->value + n;
    }

    func get(self: *Counter) -> i64 {
        return self->value;
    }
}

func main(argc, argv) -> i64 {
    // Import

    // Setup
    var counter: Counter;
    counter.init(3);

    // Execution
    counter.add(4);
    if (counter.get() != 7) { return 1; }
    counter.add(5);
    if (counter.get() != 12) { return 2; }

    // Stress: 반복 메서드 호출
    for (var i: i64 = 0; i < 1000; i = i + 1) {
        counter.add(1);
    }
    if (counter.get() != 1012) { return 3; }

    // Assertion
    return 0;
}
